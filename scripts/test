#!/usr/bin/env bash
set -euf -o pipefail

source "${BASH_SOURCE%/*}/../node_modules/sanctuary-scripts/functions"

set +f ; shopt -s globstar nullglob
files=($(get source-files))
set -f ; shopt -u globstar nullglob

node_modules/.bin/c8 \
  --check-coverage \
  --100 \
  --reporter text \
  --reporter html \
  $(printf ' --include %s' "${files[@]}") \
  node --experimental-vm-modules -- node_modules/.bin/oletus -- test/index.js
